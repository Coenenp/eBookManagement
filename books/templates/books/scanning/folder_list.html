{% extends 'books/base.html' %}
{% load static %}

{% block title %}Scan Folders - Ebook Library Manager{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'book/css/unified-tables.css' %}">
{% endblock %}

{% block extra_js %}
<script src="{% static 'book/js/unified-tables.js' %}"></script>
<script src="{% static 'book/js/scan-folder-list.js' %}"></script>
{% endblock %}

{% block content %}
<div class="unified-table-container">
    <div class="unified-table-header">
        <div>
            <h2 class="unified-table-title">
                <i class="fas fa-folder-open"></i>
                Scan Folders
            </h2>
            <p class="unified-table-subtitle">
                Manage and monitor your content scanning directories
            </p>
        </div>
        <div class="unified-table-actions">
            <a href="{% url 'books:add_scan_folder' %}" class="btn btn-primary">
                <i class="fas fa-plus me-2"></i>Add Scan Folder
            </a>
            {% if request.GET.sort %}
                <a href="{% url 'books:scan_folder_list' %}" class="btn btn-outline-secondary btn-sm">
                    <i class="fas fa-times me-1"></i>Clear Sort
                </a>
            {% endif %}
        </div>
    </div>

    <div class="table-responsive">
        <table class="table unified-table table-striped table-hover">
            <thead>
                <tr>
                    <th class="sortable-header sort-table-btn {% if sort_by == 'name' %}active sort-{{ sort_order }}{% endif %}" 
                        data-sort="name">
                        Name
                        <span class="sort-indicator"></span>
                    </th>
                    <th>Path</th>
                    <th class="sortable-header sort-table-btn {% if sort_by == 'content_type' %}active sort-{{ sort_order }}{% endif %}" 
                        data-sort="content_type">
                        Content Type
                        <span class="sort-indicator"></span>
                    </th>
                    <th class="sortable-header sort-table-btn {% if sort_by == 'language' %}active sort-{{ sort_order }}{% endif %}" 
                        data-sort="language">
                        Language
                        <span class="sort-indicator"></span>
                    </th>
                    <th class="sortable-header sort-table-btn {% if sort_by == 'is_active' %}active sort-{{ sort_order }}{% endif %}" 
                        data-sort="is_active">
                        Status
                        <span class="sort-indicator"></span>
                    </th>
                    <th class="sortable-header sort-table-btn {% if sort_by == 'last_scanned' %}active sort-{{ sort_order }}{% endif %}" 
                        data-sort="last_scanned">
                        Last Scanned
                        <span class="sort-indicator"></span>
                    </th>
                    <th class="text-center">Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for folder in object_list %}
                <tr>
                    <td class="item-name" data-label="Name">{{ folder.name }}</td>
                    <td data-label="Path">
                        <span class="path-display" title="{{ folder.path }}">{{ folder.path }}</span>
                    </td>
                    <td data-label="Content Type">
                        <span class="content-type-badge content-type-{{ folder.content_type }}">
                            {{ folder.get_content_type_display }}
                        </span>
                    </td>
                    <td data-label="Language">{{ folder.get_language_display }}</td>
                    <td data-label="Status">
                        {% if folder.is_active %}
                            <span class="status-badge status-active">
                                <i class="fas fa-check-circle"></i>Active
                            </span>
                        {% else %}
                            <span class="status-badge status-inactive">
                                <i class="fas fa-times-circle"></i>Inactive
                            </span>
                        {% endif %}
                    </td>
                    <td class="date-display" data-label="Last Scanned">
                        {% if folder.last_scanned %}
                            {{ folder.last_scanned|date:"M d, Y H:i" }}
                        {% else %}
                            <span class="date-never">Never</span>
                        {% endif %}
                    </td>
                    <td class="text-center" data-label="Actions">
                        <div class="action-buttons">
                            <a href="{% url 'books:edit_scan_folder' folder.pk %}" 
                               class="action-btn action-btn-edit"
                               title="Edit {{ folder.name }}">
                                <i class="fas fa-edit"></i>
                            </a>
                            <a href="{% url 'books:scan_folder_trigger' folder.pk %}" 
                               class="action-btn action-btn-scan"
                               title="Scan {{ folder.name }}">
                                <i class="fas fa-sync-alt"></i>
                            </a>
                            <a href="{% url 'books:delete_scan_folder' folder.pk %}" 
                               class="action-btn action-btn-delete"
                               title="Delete {{ folder.name }}">
                                <i class="fas fa-trash"></i>
                            </a>
                        </div>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="7" class="table-empty">
                        <i class="fas fa-folder-open"></i>
                        <h5>No Scan Folders</h5>
                        <p>No scan folders are configured yet.</p>
                        <a href="{% url 'books:add_scan_folder' %}" class="btn btn-primary">
                            <i class="fas fa-plus me-2"></i>Add Your First Folder
                        </a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}