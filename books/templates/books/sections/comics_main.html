{% extends "books/base_split_pane.html" %}
{% load static %}
{% load book_extras %}

{% block title %}Comics - {{ block.super }}{% endblock %}

{% block list_icon %}fas fa-mask{% endblock %}
{% block list_title %}Comics{% endblock %}
{% block item_count %}{{ comics_count }}{% endblock %}

{% block search_placeholder %}Search comics by title, author...{% endblock %}

{% block format_options %}
<option value="cbr">CBR</option>
<option value="cbz">CBZ</option>
<option value="pdf">PDF</option>
{% endblock %}

{% block items_list %}
<div id="comics-list-container">
    <!-- Comics will be loaded via AJAX -->
</div>
{% endblock %}

{% block detail_content %}
<div id="comic-detail-container" class="h-100 d-flex align-items-center justify-content-center">
    <div class="text-center text-muted">
        <i class="fas fa-mask fa-3x mb-3"></i>
        <h5>Select a comic to view details</h5>
        <p class="mb-0">Choose a comic from the list to see detailed information.</p>
    </div>
</div>
{% endblock %}

{% block extra_js %}
{{ block.super }}
<script>
    // Configuration for the comics section - SET BEFORE loading JS files
    window.comicsConfig = {
        ajax_urls: {
            list: '{% url "books:comics_ajax_list" %}',
            detail: '{% url "books:comics_ajax_detail" 0 %}',
            toggle_read: '{% url "books:comics_ajax_toggle_read" %}',
            download: '{% url "books:comics_ajax_download" 0 %}'
        },
        urls: {
            detail: '{% url "books:book_detail" 0 %}'
        }
    };

    // Base functionality integration for split-pane compatibility  
    function selectItem(itemId) {
        // Clear previous selection
        document.querySelectorAll('.list-item.selected').forEach(el => {
            el.classList.remove('selected');
        });
        
        // Add selection to new item
        const newItem = document.querySelector(`[data-item-id="${itemId}"]`);
        if (newItem) {
            newItem.classList.add('selected');
        }
        
        // Load item detail using the comics manager
        if (window.comicsManager) {
            window.comicsManager.selectItem(itemId);
        }
    }

document.addEventListener('DOMContentLoaded', function() {
    window.comicsManager = new ComicsSectionManager();
});
</script>
<script src="{% static 'book/js/media-library-utils.js' %}"></script>
<script src="{% static 'book/js/base-section.js' %}"></script>
<script src="{% static 'book/js/base-section-manager.js' %}"></script>
<script src="{% static 'book/js/comics-section.js' %}"></script>
{% endblock %}