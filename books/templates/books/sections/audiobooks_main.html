{% extends "books/base_split_pane.html" %}
{% load static %}

{% block title %}Audiobooks - {{ block.super }}{% endblock %}

{% block list_icon %}fas fa-headphones{% endblock %}
{% block list_title %}Audiobooks{% endblock %}
{% block item_count %}{{ audiobooks_count }}{% endblock %}

{% block search_placeholder %}Search audiobooks by title, author, narrator...{% endblock %}

{% block format_options %}
<option value="mp3">MP3</option>
<option value="m4a">M4A</option>
<option value="m4b">M4B</option>
<option value="flac">FLAC</option>
<option value="ogg">OGG</option>
{% endblock %}

{% block items_list %}
<div id="audiobooks-list-container">
    <!-- Audiobooks will be loaded via AJAX -->
</div>
{% endblock %}

{% block detail_content %}
<div id="audiobook-detail-container">
    <div class="d-flex align-items-center justify-content-center h-100 text-muted">
        <div class="text-center">
            <i class="fas fa-headphones fa-3x mb-3"></i>
            <h5>Select an audiobook to view details</h5>
            <p class="mb-0">Choose an audiobook from the list to see detailed information.</p>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
{{ block.super }}
<script>
// Configuration for audiobooks section - SET BEFORE loading JS files
window.audiobooksConfig = {
    ajax_urls: {
        list: '{% url "books:audiobooks_ajax_list" %}',
        detail: '{% url "books:audiobooks_ajax_detail" 0 %}'.replace('0', '{id}'),
        toggle_read: '{% url "books:audiobooks_ajax_toggle_read" %}',
        download: '{% url "books:audiobooks_ajax_download" 0 %}'.replace('0', '{id}'),
        rescan: '{% url "books:ajax_rescan_external_metadata" 0 %}'.replace('0', '{id}'),
        book_detail: '{% url "books:book_detail" 0 %}'.replace('0', '{id}'),
        book_metadata: '{% url "books:book_metadata" 0 %}'.replace('0', '{id}'),
        audiobooks_main: '{% url "books:audiobooks_main" %}'
    }
};

document.addEventListener('DOMContentLoaded', function() {
    window.audiobooksManager = new AudiobooksSectionManager();
});
</script>
<script src="{% static 'book/js/media-library-utils.js' %}"></script>
<script src="{% static 'book/js/base-section-manager.js' %}"></script>
<script src="{% static 'book/js/audiobooks-section.js' %}"></script>
{% endblock %}